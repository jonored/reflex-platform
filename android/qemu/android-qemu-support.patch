diff -Naur qemu-2.10.1/linux-user/elfload.c qemu-2.10.1-fixed/linux-user/elfload.c
--- qemu-2.10.1/linux-user/elfload.c	2017-10-02 17:23:41.000000000 -0400
+++ qemu-2.10.1-fixed/linux-user/elfload.c	2018-01-28 18:07:40.432200961 -0500
@@ -1354,7 +1354,7 @@
                                  ~(abi_ulong)(TARGET_ELF_EXEC_PAGESIZE-1))
 #define TARGET_ELF_PAGEOFFSET(_v) ((_v) & (TARGET_ELF_EXEC_PAGESIZE-1))
 
-#define DLINFO_ITEMS 14
+#define DLINFO_ITEMS 15
 
 static inline void memcpy_fromfs(void * to, const void * from, unsigned long n)
 {
@@ -1782,6 +1782,7 @@
     NEW_AUX_ENT(AT_HWCAP, (abi_ulong) ELF_HWCAP);
     NEW_AUX_ENT(AT_CLKTCK, (abi_ulong) sysconf(_SC_CLK_TCK));
     NEW_AUX_ENT(AT_RANDOM, (abi_ulong) u_rand_bytes);
+    NEW_AUX_ENT(AT_SECURE, (abi_ulong) (getuid() != geteuid() || getgid() != getegid()));
 
 #ifdef ELF_HWCAP2
     NEW_AUX_ENT(AT_HWCAP2, (abi_ulong) ELF_HWCAP2);
diff -Naur qemu-2.10.1/linux-user/ioctls.h qemu-2.10.1-fixed/linux-user/ioctls.h
--- qemu-2.10.1/linux-user/ioctls.h	2017-10-02 17:23:41.000000000 -0400
+++ qemu-2.10.1-fixed/linux-user/ioctls.h	2018-01-25 22:13:14.971134312 -0500
@@ -173,6 +173,11 @@
   IOCTL(SIOCGSTAMP, IOC_R, MK_PTR(MK_STRUCT(STRUCT_timeval)))
   IOCTL(SIOCGSTAMPNS, IOC_R, MK_PTR(MK_STRUCT(STRUCT_timespec)))
 
+  IOCTL(RNDGETENTCNT, IOC_R, MK_PTR(TYPE_INT))
+  IOCTL(RNDADDTOENTCNT, IOC_W, MK_PTR(TYPE_INT))
+  IOCTL(RNDZAPENTCNT, 0, TYPE_NULL)
+  IOCTL(RNDCLEARPOOL, 0, TYPE_NULL)
+
   IOCTL(CDROMPAUSE, 0, TYPE_NULL)
   IOCTL(CDROMSTART, 0, TYPE_NULL)
   IOCTL(CDROMSTOP, 0, TYPE_NULL)
diff -Naur qemu-2.10.1/linux-user/syscall.c qemu-2.10.1-fixed/linux-user/syscall.c
--- qemu-2.10.1/linux-user/syscall.c	2017-10-02 17:23:41.000000000 -0400
+++ qemu-2.10.1-fixed/linux-user/syscall.c	2018-01-25 22:12:49.916430450 -0500
@@ -59,6 +59,7 @@
 #include <linux/icmp.h>
 #include <linux/icmpv6.h>
 #include <linux/errqueue.h>
+#include <linux/random.h>
 #include "qemu-common.h"
 #ifdef CONFIG_TIMERFD
 #include <sys/timerfd.h>
diff -Naur qemu-2.10.1/linux-user/syscall_defs.h qemu-2.10.1-fixed/linux-user/syscall_defs.h
--- qemu-2.10.1/linux-user/syscall_defs.h	2017-10-02 17:23:41.000000000 -0400
+++ qemu-2.10.1-fixed/linux-user/syscall_defs.h	2018-01-25 22:12:49.916430450 -0500
@@ -1060,6 +1060,13 @@
 
 #define TARGET_SIOCGIWNAME     0x8B01          /* get name == wireless protocol */
 
+/* From <linux/random.h> */
+
+#define TARGET_RNDGETENTCNT    TARGET_IOR('R', 0x00, int)
+#define TARGET_RNDADDTOENTCNT  TARGET_IOW('R', 0x01, int)
+#define TARGET_RNDZAPENTCNT    TARGET_IO('R', 0x04)
+#define TARGET_RNDCLEARPOOL    TARGET_IO('R', 0x06)
+
 /* From <linux/fs.h> */
 
 #define TARGET_BLKROSET   TARGET_IO(0x12,93) /* set device read-only (0 = read-write) */

